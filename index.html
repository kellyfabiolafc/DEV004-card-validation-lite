<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Tarjeta de crédito válida</title>
  <link rel="stylesheet" src="estilos.css"> </head>


<body >
<h1>COMPROBEMOS TU TARJETA ;D </h1>
  <form id="miformulario">
    <td><strong>Número de tarjeta: </strong></td>
    <input type="text" name="number" id="cardnumber" maxlength="16">
  <button onclick="validate()">Validar</button>

  <div id="result"></div>
</form>
<script lang="javascript">
 document.getElementById("cardnumber").oninput = function() {
  this.value = this.value.replace(/[^0-9]/g,'');
}
   function validate() {
    const valid = isValid(document.getElementById("cardnumber").value)
    event.preventDefault();
   if (document.getElementById("cardnumber").value.length === 0) {
    alert ("Por favor , ingrese los datos a validar")
    document.getElementById("result").innerHTML = 'Lo sentimos , no podemos validar si no ha ingresado los datos requeridos';
    
   }
    else if (valid){  
      // Show success in div#result
      //alert(valid);
      alert("Genial, el número de  tarjeta insertada  es correcta " )
      //console.log(valid);
      document.getElementById("result").innerHTML = 'tarjeta valida';
    }
    else {
      // Show error message in div#result
      alert( "Lo sentimos,intente con otro número de tarjeta" );
      document.getElementById("result").innerHTML = 'tarjeta invalida';
  }
    }
   
      function isValid(creditCardNumber){ {
        var cantidadRecorridos=creditCardNumber.length;
        function invertirCadena(creditCardNumber) {
          if (creditCardNumber === "")
            return "";
          else
            return invertirCadena(creditCardNumber.substr(1)) + creditCardNumber.charAt(0);
     }
}

var numerotarjetainvertida
numerotarjetainvertida=invertirCadena(creditCardNumber);

//console.log( //"numerodelatarjetaoriginal:"
//creditCardNumber);
//console.log(//"numerodelatarjetainvertida:"
//numerotarjetainvertida);

var cantidadRecorridos;
cantidadRecorridos=creditCardNumber.length;
var SumaValoresdePocisionesPares=0;
var SumaValoresdePocisionesImPares=0;

for (i=0;i<cantidadRecorridos;i++)
			{
				let valordeCarater;
				valordeCarater = parseInt( numerotarjetainvertida.charAt(i)) ; 
        //console.log(valordeCarater)
                //captura de los valores de pocisiones pares y suma acumulativa de los mismos
				if (i%2===0)
					{SumaValoresdePocisionesPares=SumaValoresdePocisionesPares+valordeCarater;}
        //creo que esto dice que si la psicion se divide en dos y da 1 como residuo sera considerado como inpar y por ende sera multiplicado 
				if (i%2===1){ValInpar=valordeCarater*2;
					if (ValInpar>9)
							{
							//esta indicando que si el resultado de la posicion es mayor a 9 se aplicara una formulita que hara que se separen y sumen
							ValInpar = parseInt( (ValInpar.toString().charAt(0)))+ parseInt( (ValInpar.toString().charAt(1)));
							}
							SumaValoresdePocisionesImPares=SumaValoresdePocisionesImPares+ValInpar;
              //console.log("Suma de posiciones pares:" + SumaValoresdePocisionesPares);
              //console.log("Suma de posiciones pares:" + SumaValoresdePocisionesImPares);
					}
			}
      //alert ("llego aqui");



let SumaTotal;
SumaTotal=SumaValoresdePocisionesImPares+SumaValoresdePocisionesPares;
//console.log("SUMA TOTAL:");
//console.log(SumaTotal);

//Verificar Si la suma total termina en 0
let ValEnds;
 ValEnds= SumaTotal%10;

if (ValEnds===0){ 
  //console.log("Tarjeta de credito valida");
  return true;
 } else {
return false;
}
 
    
    }

</script>

</body>

</html>